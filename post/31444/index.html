<!DOCTYPE html>
<html
  lang="zh-cn"
  itemscope
  itemtype="http://schema.org/WebPage"
>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
          zkRollup 相关讨论两则 - 区块大全
        </title>
    

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="佚名" /><meta name="description" content="侧链不能提供与 L1 同样的安全性。Statechain 不是完全免信任的。" />
<meta name="keywords" content="Rollup" />







<meta name="generator" content="Hugo 0.120.4" />


<link rel="canonical" href="/post/31444/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.d8d87b982993a745e5e7b6a6cbf257be8c3e82aab5e485f0908ad7e6c3501ab2.css" integrity="sha256-2Nh7mCmTp0Xl57amy/JXvow&#43;gqq15IXwkIrX5sNQGrI=" media="screen" crossorigin="anonymous">







<meta property="og:title" content="zkRollup 相关讨论两则" />
<meta property="og:description" content="侧链不能提供与 L1 同样的安全性。Statechain 不是完全免信任的。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/31444/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-03T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-12-03T00:00:00+00:00" />

<meta itemprop="name" content="zkRollup 相关讨论两则">
<meta itemprop="description" content="侧链不能提供与 L1 同样的安全性。Statechain 不是完全免信任的。"><meta itemprop="datePublished" content="2021-12-03T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-12-03T00:00:00+00:00" />
<meta itemprop="wordCount" content="6896">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="zkRollup 相关讨论两则"/>
<meta name="twitter:description" content="侧链不能提供与 L1 同样的安全性。Statechain 不是完全免信任的。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




  </head>
  <body>
    <div id="back-to-top"></div>

    <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">区块大全</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/categories/">分类</a>
          
        
      </li>
    

    
  </ul>
</nav>


    
      






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

    

    

    


    <header id="header" class="header">
      <div class="logo-wrapper">
  <a href="/" class="logo">
    
      区块大全
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/categories/">分类</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

    </header>

    <div id="mobile-panel">
      <main id="main" class="main bg-llight wallpaper">
        <div class="content-wrapper">
    <div id="content" class="content">
      <article class="post">
        
        <header class="post-header">
          <h1 class="post-title">zkRollup 相关讨论两则</h1>
          

          <div class="post-meta">
  <div class="post-meta-author">
    by
      佚名
    
  </div>

  <div class="post-meta-time">
    <time datetime="2021-12-03">
      2021-12-03
    </time>
  </div>

  


  <div class="post-meta__right">
    <span class="post-meta-more">
        约 6896 字 -
        预计阅读 14 分钟
      </span>

    <div class="post-meta-category">
        <a href="/categories/%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0/"> 其它文章 </a>
          
      </div>


    
    


    
    
  </div>
</div>

        </header>

        
        <div class="post-content">
          <table>
    <thead>
        <tr>
            <th style="text-align:left">推荐平台</th>
            <th style="text-align:left">链接</th>
            <th style="text-align:left">平台介绍</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">币安网</span></td>
            <td style="text-align:left"><span style="white-space:nowrap"><a
                        href="https://www.okbtc.cn/binance?ref=githubio">注册链接</a></span></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/binance?ref=githubio">币安是全球领先的区块链生态系统，推出了一系列产品，其中包括最大的加密货币交易平台。我们的使命是在未来成为全球性加密货币基础架构供应商。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">欧易OKX</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/okx?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/okx?ref=githubio">欧易是全球著名的数字资产交易平台之一，主要面向全球用户提供比特币、莱特币、以太币等数字资产的币币和衍生品交易服务。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">HTX火币</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/htx?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/htx?ref=githubio">火币全球专业站，是火币集团旗下服务于全球专业交易用户的创新数字资产国际站，致力于发现优质的创新数字资产投资机会。</a>
            </td>
        </tr>
    </tbody>
</table>
<p><strong>第一则</strong> ：</p>
<p>链接：https://twitter.com/SomsenRuben/status/1349437071686062083</p>
<p>@StopAndDecrypt：</p>
<p>有没有比特币爱好者来解释下 zkrollup？</p>
<p>我不指望以太坊的开发者会诚实地讲清楚其中的权衡，也不指望以太坊的粉丝真的明白它是怎么工作的。</p>
<p>（这是个严肃的问题哦）</p>
<p>@SomsenRuben：</p>
<p>用比特币的术语来说，就是一个大区块方案 —— 每个人都要下载额外的数据。<strong>在交易进入区块之前，一个中间人先使用一个 SNARK 证据来 聚合/压缩 所有的见证数据（witness，比如签名）（当前的 SNARK 需要使用受信任的启动设置），并发布新状态的 UTXO 集合承诺（也是用上述的 SNARK 证据来证明的）。</strong></p>
<p>每个人都验证这个 SNARK，证明区块的有效性和 UTXO 集合承诺的正确性。没人必须生成 UTXO 集合，因为 SNARK 已经证明过了，只要你想，你就能生成出来。如果那个中间人失踪了，你只需使用 UTXO 集合承诺证明自己的状态即可动用资金。</p>
<p>简而言之，好处是你可以节约见证数据和计算量（都外包给了 SNARK 证据）。zkrollup 只是应用了我们一直知道的 SNARK 能做的事，可能差别只在于它用在了单独的一个 UTXO 集合上。</p>
<p>亦见我写的 SNARK 文章：SNARK 与区块链的未来。（译者注：下文有附。非常清楚地说明了 SNARK 能做的事，以及为什么 zkrollup 要把不含见证数据的交易数据发布出来。）</p>
<p><strong>第二则</strong> （很长，请耐心）：</p>
<p>_链接：_<em><a href="https://twitter.com/SomsenRuben/status/1420299197979504642">https://twitter.com/SomsenRuben/status/1420299197979504642</a></em></p>
<p>（略去两人对二层网络兴起会不会降低对一层区块空间需求的讨论）</p>
<p>@AdrianoFeria：</p>
<p>侧链不能提供与 L1 同样的安全性。Statechain 不是完全免信任的。我还没研究 Chaumian banks。</p>
<p>@bergealex4：</p>
<p>（侧链）当然不能，它从来也没说自己能。</p>
<p>你没法跨层复制 L1 的安全性。</p>
<p>@AdrianoFeria：</p>
<p>“你没法跨层复制 L1 的安全性。”</p>
<p>这就是 ZK-Rollup 能做到的事。</p>
<p>@bergealex4：</p>
<p>好吧，即使我们接受这个前提，光凭这一点也不能让 ETH 优于 BTC。</p>
<p>@AdrianoFeria：</p>
<p>就凭这一点，以太坊就有了一种扩容机制，可以保留 L1 的安全性，同时无需付出 开启/关闭 通道的开销，也不必承担闪电网络内在的数据可得性风险。</p>
<p>我们没法靠推特来讨论哪个系统在整体上更优。</p>
<p>无论如何，zk-rollup 是一个大进步，并且提供了比支付通道更大的好处。</p>
<p>@SomsenRuben：</p>
<p>ZK-rollup 和支付通道是不同维度的（orthogonal）。zk-rollup 就像扩大的区块（extention block） —— 非见证数据放到链上，并由每一个人（通过 SNARK，便宜地）验证。我可以理解为什么你们管它叫 “L2”，但从技术上来说，它其实不是。它只是做了非交互的见证数据聚合（NIWA）。看我的文章 《SNARK 与区块链的未来》。</p>
<p>@AdrianoFeria：</p>
<p>它是个 L2，因为 SNARK 的计算是委托给另一个网络的。L1 只用来存储证明，结果是它提高了 L1 的吞吐量大约 100 倍。据我了解，它就相当于无损压缩。</p>
<p>@SomsenRuben：</p>
<p>“L2” 只是个标签。关键是我们同意这个过程里面 SNARK 做了什么 —— 非交互的见证数据聚合，这个也可以用在主链上（就是完全用在 L1 上，由矿工来做 NIWA），或者用在链中链上（就像 zk-rollup 一样，但它就是 “扩大的区块”）。</p>
<p>在比特币网络中，见证数据只占区块的 50%（跟以太坊不同），所以你最多只能获得 2 倍的效率提升（从区块空间的角度来看），而且这是假设了完美的 SNARK 技术；这个扩容效果很一般。即使运用了它，支付通道仍显然是有好处的。</p>
<p>@AdrianoFeria：</p>
<p>在 rollup 基础上再运行支付通道就不可能吗？</p>
<p>@SomsenRuben：</p>
<p>当然可以，这就是为什么我说他们不是同一个维度的。</p>
<p>（略）</p>
<p>@AdrianoFeria：</p>
<p>是不是可以断言，它（zk-rollup）提高了 L1 的吞吐量，代价是增加了额外的计算量（在以太坊的情形下，由于当前的规范要求，验证者没法这么做）？而且，即使证据的提供者崩溃了，资金也仍然可以取回。</p>
<p>@SomsenRuben：</p>
<p>我那篇文章提出的 NIWA 概念解释了这种直觉。任何人都可以收集所有的见证数据（包括签名在内、证明交易合法性的数据）并 压缩/聚合 成一个 SNARK 证据。只需某人付出多一点，结果有益所有人。</p>
<p>资金总是可以取回的，证据的提供者也总是可以替换的。</p>
<p>@AdrianoFeria：</p>
<p>我理解这些，但理想情况下，SNARK 的计算应该作为一项服务，由一个去中心化的网络来提供。这就是以太坊生态里面正在发生的事，而且我看不出为什么类似的东西对比特币来说就不可取。</p>
<p>@SomsenRuben：</p>
<p>它总有可取之处，但你过高地估计了它的好处（扩容效果最多只有 2 倍），也低估了它的代价（其数学原理未经考验、不使用受信任的启动设置就很低效，以及矿工的中心化）。</p>
<p>我确实相信有一天 SNARK 会成熟，会变得很有意义，但现在还没到时候。</p>
<p>@AdrianoFeria：</p>
<p>普遍共识是，zkrollup 在以太坊上的扩容效果是 100 倍（这个信息在多个信息源中是一致的）。</p>
<p>为什么它对比特币就没有这样的效果呢？</p>
<p>@SomsenRuben：</p>
<p>我能想到的两个原因：</p>
<p>相比比特币，以太坊中的 witness 数据大得多，验证起来也更昂贵 —— 所以 SNARK 能更好地缓解以太坊的低效率。</p>
<p>地址重用进一步减少了非见证数据 —— 对比特币来说，这种隐私上的牺牲也是不太可能被接受的。</p>
<p>我的主张是很容易推理的：</p>
<ul>
<li>
<p>SNARK 只能减少见证数据</p>
</li>
<li>
<p>比特币的见证数据大约占区块的 50%</p>
</li>
</ul>
<p>只要你理解这些，你就不需要 “相信我是个专家”，但 100 倍的说法，实在是很难推理出来。</p>
<p>@AdrianoFeria：</p>
<p>我没有在任何地方看到有人挑战这个 100 倍的说法。我假设 zkrollup 的技术设计可能稍微不同于你用比特币来举的例子，以及/或者 跟 UTXO 或比特币脚本的限制有关。</p>
<p>@SomsenRuben：</p>
<p>我不会那么快就开始假设。“别信任，自己验证”。</p>
<p>总的来说，我也建议你不要为某种主张辩护，除非你有非常强的信心。谦虚一些，http://www.paulgraham.com/identity.html</p>
<p>@AdrianoFeria：</p>
<p>所以我也欢迎对这个说法的技术上的挑战呀。基于一个事实：它已经被许多著名的开发者引用，也广为流传，也没有被挑战，偏向这个陈述是合理的。Rollup 已经快集成好了，证据就在眼前。</p>
<p>你需要务实地遵守这个 “别信任，自己验证” 的信条。相信某些东西，而不是自己验证每一件事，是有理由的。比如：</p>
<ul>
<li>
<p>相信 SHA-256 运作良好</p>
</li>
<li>
<p>相信公钥密码学</p>
</li>
<li>
<p>为客户端创建二进制未见得编译器是有效的</p>
</li>
</ul>
<p>@SomsenRuben：</p>
<p>我只不过给了一种你（应该）可以验证的，比特币无法靠 SNARK 实现两倍以上扩容，的证明。</p>
<p>从这个角度看，说以太坊可以实现 100 倍扩容的主张至少可以开始怀疑。</p>
<p>如果这还不叫 “验证”，那我也不知道什么是。</p>
<p>@AdrianoFeria：</p>
<p>我一直没法完全消化这一点，但这篇文章看起来与你用比特币来描述的情形完全不同。你有什么评论吗？https://medium.com/interdax/ethereum-l2-optimistic-and-zk-rollups-dffa58870c93</p>
<p>@SomsenRuben：</p>
<p>文章里列举了许多扩容方案，但就我所知，除了 zk-rollup，其它方案都已经被以太坊社区抛弃了。</p>
<p>但相比之下，我更了解比特币。如果你对我的文章有什么疑问，我很乐于帮你解答。这也会间接帮你了解以太坊。</p>
<p>@AdrianoFeria：</p>
<p>Vitalik 刚刚发布了这篇文章，我还没来得及看，但它似乎讲解了许多技术设计上的细节，以及各种类型的交易能压缩多少数据的细节。《Rollup 不完全指南》</p>
<p>@SomsenRuben：</p>
<p>好文章。所以我的两个理由都是对的，但现在我更理解这个 100 倍是怎么来的了。在以太坊中，空间和计算量都要消耗 gas，但前者的 gas 成本更低。因为 SNARK 将计算量降到了接近 0，所以所有的 gas 都可以用来发布数据。缺点是什么？区块变得更大。</p>
<p>@AdrianoFeria：</p>
<p>区块是变得更大了，但这是我知道的对存储空间最有效率的用法。</p>
<p>另外，这篇文章也证明了，一笔普通的交易可因此节约 10 倍空间。所以，这说明 rollup 比你用比特币来描述的情形有 5 倍的效率优势。这可不小了。</p>
<p>@SomsenRuben：</p>
<p>你忘了第二个代价，地址重用，这是个很严重的隐私降级。你也可以为比特币引入这样的反向升级来节约区块空间，以前也有人提议过，但大家以很好的理由拒绝了。</p>
<p>@AdrianoFeria：</p>
<p>我看不出地址重用怎么就是专属于 rollup 的问题，而且这个问题也可以通过专门设计的提高隐私性的智能合约来缓解。而且，钱包就不能每次收银都使用一个新地址、模拟 UTXO 的隐私性吗？</p>
<p>@SomsenRuben：</p>
<p>关键在于地址重用就是他们缩小交易体积的办法呀。如果你为每一笔交易都使用一个新地址（以及找零地址），那 zk-rollup 的交易体积会大得多。</p>
<p>（这场讨论中还有其它旁生的讨论，在此不附）</p>
<p>（译者注：不知道读者还记不记得 zk-rollup 的扩容效果是怎么论证出来的。简单来说，它是假设一笔普通交易在主链上发生要消耗 X 单位 gas，而在 zk-rollup 上发生只需消耗 Y 单位 gas，所以扩容效果是 X/Y。换言之，所有的论证都基于不同操作在以太坊上的 gas 定价，但是，gas 并不是一种真实的资源，它只是一种虚拟的单位并假设了不同的资源的代价可以化约到一个指标。假如你现在把 calldata 的 gas 定价下调一倍，zk-rollup 的扩容效果就可以提高一倍（EIP-4488 和 4490 正有这样的意思）。这不是有点儿戏吗？相反，Somsen 对 SNARK 扩容效果的论证更接近于技术本来的面目，它就是节约见证数据（以及理想情况下，节约验证计算量）而已。</p>
<p>另外，zk-rollup 也确实有地址重用的问题（见这篇文章）。Adriano 所谓的模拟 UTXO，每次都使用一个新地址的办法，不是不行，但在以太坊的世界里不是一个良好实践，因为所有的历史地址都会留在状态中，变成节点的负担，这就是所谓的状态爆炸问题。</p>
<p>下面，是 Somsen 的文章）</p>
<h1 id="snark-与区块链的未来"><strong>SNARK 与区块链的未来</strong></h1>
<blockquote>
<p><em>作者：Ruben Somsen</em></p>
<p>_来源：_<em><a href="https://medium.com/@RubenSomsen/snarks-and-the-future-of-blockchains-55b82012452b">https://medium.com/@RubenSomsen/snarks-and-the-future-of-blockchains-55b82012452b</a></em></p>
</blockquote>
<p>SNARK（succinct non-interactive argument of knowledge，简洁的非交互式知识证明）常被认为是 “解决” 扩容问题的灵丹妙药。虽然 SNARK 可以提供难以想象的好处，但我们也要知道 —— SNARK 无法解决区块链当前面临的带宽约束问题。</p>
<p>本文希望能通过（相对）简要地介绍 SNRAK 能为区块链做什么和不能做什么，来揭开 SNARK 的神秘面纱。我们会先谈谈，为什么它与区块链有关的功能可以被简洁地归纳为 “非交互式见证数据压缩（NIWA）”。只要你知道比特币是怎么运行的，你就能理解这篇文章。</p>
<p>应当指出的是，SNARK 在很大程度上仍然处于活跃的研究阶段。许多 SNARK 的变种，要么效率不足以至于无法证明复杂的语句（statement），要么证明的体积非常大，大到不切实际，要么需要一个受信任的启动设置（trused setup）。也就是说，虽然这几年我们看到了许多进展，预计未来数十年我们还将看到更多。本文的写作对这些进展有预期，即使它们今天看来可能不实用。</p>
<h2 id="什么是-snark-"><strong>什么是 SNARK ?</strong></h2>
<p>SNARK 是一种技术，让你可以在给定一个规则集和一个起始状态时，高效地验证一个结果。导致这个结果的输入是不公开的（“零知识性”）。听起来一头雾水？我们拿象棋举一个简单的例子的好了。</p>
<p><strong>象棋案例</strong></p>
<ul>
<li>
<p>规则：象棋规则</p>
</li>
<li>
<p>起始状态：棋盘的起始局面 A</p>
</li>
<li>
<p>结果：棋盘的新局面 B</p>
</li>
</ul>
<p>证明棋局从局面 A 到局面 B 是有效转换的传统方法是公开每一个步骤并检查每一步是不是都有效。SNARK 也同样能用来检查状态转换的有效性，但效果更好：</p>
<ul>
<li>
<p>步骤不必公开（隐私性、节约数据）</p>
</li>
<li>
<p>验证在计算上更高效</p>
</li>
</ul>
<p>但有一个问题 —— 创建 SNARK 的计算成本很高。不过，在一个许多人都想验证同一个结果的系统（比如区块链）中，使用这种技术可能仍是值得的。只需要一个人花力气来创建 SNARK，就能提高所有人的验证效率。</p>
<p><strong>区块链案例</strong></p>
<ul>
<li>
<p>规则：全节点软件</p>
</li>
<li>
<p>起始状态：时间点 A 的区块头和 UXTO 集合哈希值</p>
</li>
<li>
<p>结果：时间点 B 的区块头和 UTXO 集合</p>
</li>
</ul>
<p>类似于我们上面提到的象棋，验证状态转换有效性的常规方法是：从时间点 A 的 UTXO 集合（所有未花费的交易）开始，接收截至 B 点所有的区块并更新 UTXO 集合。有了 SNARK，那就不需要这些数据来证明有效性了。实际上，如果时间点 A 被设为创世区块（空的 UTXO 集合），而时间点 B 被设成现在，那么无需接收任何历史数据就能验证整条链。</p>
<p>重要的是，你需要 B 点的整个 UTXO 集合，而关于 A 点你只需要知道 UTXO 集合的哈希值。虽然这个数据不是证明有效性严格必需的，但我们也关心 <em>可得性</em>。如果你总是只能拿到 UTXO 集合的哈希值，那即使你知道一个有效的状态存在，你也不能知道那个状态究竟是什么。也就是说你没法花费任何资金，因为你没有数据来证明某个 UTXO 属于当前的集合。如果以象棋为类比，那就是你知道了一个新局面的哈希值，但你并不知道那个局面到底是怎么样的，所以也没法继续玩这个游戏。</p>
<p>记住，无论是谁来创建 SNARK（假设是矿工）都要具备这个数据（结果 UTXO 集合）（因为这是创建 SNARK 必需的），但他们可能会选择扣住数据，不发给你。</p>
<h2 id="snark-区块链"><strong>SNARK 区块链</strong></h2>
<p>为了保证每个人都会花费自己的钱，更新 UTXO 集合所需的所有数据都必须与每个区块一起传播。你还是要知道哪些 UTXO 被花费了（即输入）、哪些 UTXO 新产生了（输出）。这就是所谓的 “非见证数据”。</p>
<p>状态转换的有效性可以靠一个 SNARK 来验证，因此 SNARK 可以取代所有的见证数据（脚本、签名），而且几乎不占用带宽。输入和输出之间的关联将被抹消 —— 一个区块看起来就像一笔很大的 coinjoin 交易一样。大部分数据都是非见证数据。</p>
<p>所以，与大众的想象相反，SNARK 无法解决轻客户端或者非联盟侧链背后的根本问题，因为你必须下载非见证数据。如果非见证数据丢失，全节点有能力拒绝一个有效的 SNARK；但如果一个轻客户端疏忽于下载非见证数据，它可能会错误地认为一个数据丢失的链是有效的。即使非见证数据的一小块被矿工扣住了，其他人也就没法在有效的 SNARK 上创建新区块 —— 最终它会变成一个许可型系统。</p>
<h2 id="snark-消耗见证数据"><strong>SNARK 消耗见证数据</strong></h2>
<p>用于区块链的 SNARK 最好的总结可能是，它可以启用一种功能：非交互的见证聚合（NIWA）。</p>
<p>我在这里使用 “见证” 一词是比较随意的。在比特币中，见证数据是放在交易中、用来证明具体的 UTXO 是否能够合法创建出来的数据。但随着时间推移，这个 UTXO（非见证数据）也会变成自身的见证数据，在它被花费的时候。假设 1 btc 从 Alice 转给了 Bob 又转给了 Carol，Bob 的交易就是从 Alice 到 Carol 的转账的见证数据。同样地，创世块以来的所有支付交易，都是当前 UTXO 集合的见证数据s。</p>
<p>同样要指出的是，一个 SNARK 自身就是一个见证数据。如果每一笔交易都由一个 SNARK 来验证，我们也可以将这些 SNARK 都聚合（NIWA）在一起、为区块生成单个的 SNARK。而且，因为输出在花费时会变成见证数据，我们甚至可以在交易池中取出未上链确认、但已经被花费的输出，并聚合它们。Alice 转给 Bob 再转给 Carol 会变成 Alice 转给 Carol，实现非交互的交易合并（transaction cut-through）。当带有许多链外交易分支的单个 UTXO 被强制上链时（比如闪电网络通道工厂），这种功能特别有用。</p>
<h2 id="简单总结"><strong>简单总结</strong></h2>
<p>我们已经用 NIWA 概念总结了 SNARK 为区块链提供的核心功能。任何见证数据都可以被一个 SNARK 非交互式地聚合在一起。而剩下的非见证数据就是对系统状态（UTXO 集合）的直接反映。虽然 SNARK 可以实现一些神奇的功能，比如直接下载一个 UTXO 集合和一个 SNARK 就从创世状态跳跃到最新状态、非交互式地将未上链交易的序列聚合为单笔交易，但我们还是需要为每一个新区块发布所有的非见证数据，以使所有的全节点都能更新他们的 UTXO 集合。因此，SNARK 无法解决区块链面临的带宽根本约束。</p>
<p>感谢 Sanket Kanjalkar 富有教益的讨论和评论。</p>
<p>- NIWA 在行动。SNARK 消耗 witness，但自身也是一个 witness。所以 SNARK 可以吞吃 SNARK -</p>
<table>
    <thead>
        <tr>
            <th style="text-align:left">推荐平台</th>
            <th style="text-align:left">链接</th>
            <th style="text-align:left">平台介绍</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Gate芝麻开门</span></td>
            <td style="text-align:left"><span style="white-space:nowrap"><a
                        href="https://www.okbtc.cn/gateio?ref=githubio">平台介绍</a></span></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/gateio?ref=githubio">Gate.io芝麻开门创立于2013年，是全球真实交易量TOP10的加密货币交易平台，向全球数千万用户提供安全可靠、真实透明的数字资产交易服务。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Bitget</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/bitget?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/bitget?ref=githubio">Bitget的背后是一群区块链技术的早期接受者，也是区块链未来发展的信仰者，一直致力于提供安全、一站式的交易解决方案，帮助用户更聪明地交易。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Bybit</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/bybit?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/bybit?ref=githubio">Bybit通过数字资产与传统金融的结合，引领数字资产的生态发展。提供一流的流动性，致力于打造业内最安全、公平、高效及人性化的交易服务平台。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">派网</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/pionex?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/pionex?ref=githubio">派网提供多样化的量化交易机器人，用户可依照自身交易需求和策略选择最适合的机器人。 同时派网也提供合约交易与合约网格机器人，给予更方便的合约交易体验。</a>
            </td>
        </tr>
    </tbody>
</table>

        </div>

        
        



        
        


        <footer class="post-footer">
          


          
          <nav class="post-nav">
            
              <a class="prev" href="/post/31441/">
                
                <i class="iconfont">
                  <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

                </i>
                <span class="prev-text nav-default">Web3.0 时代 我们的生活将产生什么变化？</span>
                <span class="prev-text nav-mobile">上一篇</span>
              </a>
            
              <a class="next" href="/post/31447/">
                <span class="next-text nav-default">比特币矿企TeraWulf获得2亿美元的债务和股权融资</span>
                <span class="prev-text nav-mobile">下一篇</span>
                
                <i class="iconfont">
                  <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

                </i>
              </a>
          </nav>
        </footer>
      </article>

      
      
        
      


      
      


    </div>

    
    <nav class="toc" id="toc">
    <div class="toc-title">文章目录</div>
    <div class="toc-content custom-scrollbar">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#什么是-snark-"><strong>什么是 SNARK ?</strong></a></li>
    <li><a href="#snark-区块链"><strong>SNARK 区块链</strong></a></li>
    <li><a href="#snark-消耗见证数据"><strong>SNARK 消耗见证数据</strong></a></li>
    <li><a href="#简单总结"><strong>简单总结</strong></a></li>
  </ul>
</nav>
    </div>
  </nav>


  </div>

      </main>

      <footer id="footer" class="footer">
        <div class="icon-links">
  

<a href="https://www.okbtc.cn/binance?ref=githubio" class="iconfont">
  <img src="/image/logo/binance.png" width="36px" height="36px" alt="binance">
</a>

<a href="https://www.okbtc.cn/okx?ref=githubio" class="iconfont">
  <img src="/image/logo/okx.png" width="36px" height="36px" alt="okx">
</a>

<a href="https://www.okbtc.cn/htx?ref=githubio" class="iconfont">
  <img src="/image/logo/htx.png" width="36px" height="36px" alt="htx">
</a>

<a href="https://www.okbtc.cn/gateio?ref=githubio" class="iconfont">
  <img src="/image/logo/gateio.png" width="36px" height="36px" alt="gateio">
</a>

<a href="https://www.okbtc.cn/bitget?ref=githubio" class="iconfont">
  <img src="/image/logo/bitget.png" width="36px" height="36px" alt="bitget">
</a>

<a href="https://www.okbtc.cn/bybit?ref=githubio" class="iconfont">
  <img src="/image/logo/bybit.png" width="36px" height="36px" alt="bybit">
</a>

<a href="https://www.okbtc.cn/pionex?ref=githubio" class="iconfont">
  <img src="/image/logo/pionex.png" width="36px" height="36px" alt="pionex">
</a>



</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    2023
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        coin
        
      </span></span>

  
  

  
</div>

      </footer>

      <div class="button__back-to-top">
        <a href="#back-to-top">
          <i class="iconfont">
            
            <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

          </i>
        </a>
      </div>
    </div>
    
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.308d1186d284e0b3f5e6187c85ea0a927fdc75459dbd958fc0fb1f4400ed52ee.js" integrity="sha256-MI0RhtKE4LP15hh8heoKkn/cdUWdvZWPwPsfRADtUu4=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  











<script>
  var remark_config = {
    host: 'https:\/\/remark42.example.com',
    site_id: 'remark',
    components: [
	    'embed',
    ],
  }
  !function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);
</script>







  </body>
</html>
